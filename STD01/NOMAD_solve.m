clear;

step = 0.28;
eps1 = 0.0125;
eps2 = 0.0025;
eps3 = 10^(-2)/0.0125;
max_calls = 3125;
constraint = [0, 1; 0, 1; 0, 1; 0, 1; 0, 1];
j = 1;

initial = [1/4, 1/4, 1/4, 1/4, 1/4;
          1/4, 1/4, 1/4, 1/4, 3/4;
          1/4, 1/4, 1/4, 3/4, 1/4;
          1/4, 1/4, 1/4, 3/4, 3/4;
          1/4, 1/4, 3/4, 1/4, 1/4;
          1/4, 1/4, 3/4, 1/4, 3/4;
          1/4, 1/4, 3/4, 3/4, 1/4;
          1/4, 1/4, 3/4, 3/4, 3/4;
          1/4, 3/4, 1/4, 1/4, 1/4;
          1/4, 3/4, 1/4, 1/4, 4/4;
          1/4, 3/4, 1/4, 3/4, 1/4;
          1/4, 3/4, 1/4, 3/4, 3/4;
          1/4, 3/4, 3/4, 1/4, 1/4;
          1/4, 3/4, 3/4, 1/4, 3/4;
          1/4, 3/4, 3/4, 3/4, 1/4;
          1/4, 3/4, 3/4, 3/4, 3/4;
          3/4, 1/4, 1/4, 1/4, 1/4;
          3/4, 1/4, 1/4, 1/4, 3/4;
          3/4, 1/4, 1/4, 3/4, 1/4;
          3/4, 1/4, 1/4, 3/4, 3/4;
          3/4, 1/4, 3/4, 1/4, 1/4;
          3/4, 1/4, 3/4, 1/4, 3/4;
          3/4, 1/4, 3/4, 3/4, 1/4;
          3/4, 1/4, 3/4, 3/4, 3/4;
          3/4, 3/4, 1/4, 1/4, 1/4;
          3/4, 3/4, 1/4, 1/4, 4/4;
          3/4, 3/4, 1/4, 3/4, 1/4;
          3/4, 3/4, 1/4, 3/4, 3/4;
          3/4, 3/4, 3/4, 1/4, 1/4;
          3/4, 3/4, 3/4, 1/4, 3/4;
          3/4, 3/4, 3/4, 3/4, 1/4;
          3/4, 3/4, 3/4, 3/4, 3/4;
          ];

p = randperm(32, 32);

while max_calls >= 11
    
    x_0 = zeros(5, 1);
    for i = 1:5
        x_0(i)  = constraint(i, 1) + initial(p(j), i) * (constraint(i, 2) - constraint(i, 1));
    end
    
    f = @(x) Scaled_Solid_Tank_Problem(x);
    params = struct('initial_mesh_size', num2str(step), 'MAX_BB_EVAL', num2str(max_calls)); 
    tic;
    [x, fval, exitflag, iter, nfval] = nomad(f, x_0, [0;0;0;0;0], [1;1;1;1;1],[],[],['C','C','C','C','C'], params);
    time = toc;
    save("FlexDos_NOMAD_Result_" + num2str(j) + ".mat")
    max_calls = max_calls - nfval;
    j = j + 1;
    
end






